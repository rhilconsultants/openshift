<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=VeIFfpj9IqqkGQRjzdagvoskxxPf4zrOXex0HDuv2iN9cV9bUZ7wyyOLwBbBZJCuj8PlazIki3J4dESKvXwR77IvMkkUrPlJB0TDu9ieq24gasJ5l9Y7LtK6p5_KK0majeqPjWB0Q6qIHw_BcJQqMKyncXd3RsKv_kXJkx506TM');.lst-kix_n3kvfh5c5sox-4>li:before{content:"\0025cb  "}.lst-kix_n3kvfh5c5sox-5>li:before{content:"\0025a0  "}.lst-kix_sryvi1qtsqre-1>li:before{content:"\0025cb  "}.lst-kix_sryvi1qtsqre-2>li:before{content:"\0025a0  "}.lst-kix_n3kvfh5c5sox-1>li:before{content:"\0025cb  "}.lst-kix_n3kvfh5c5sox-2>li:before{content:"\0025a0  "}.lst-kix_n3kvfh5c5sox-3>li:before{content:"\0025cf  "}.lst-kix_6z2a8aoqt4nu-8>li:before{content:"\0025a0  "}.lst-kix_sryvi1qtsqre-0>li:before{content:"\0025cf  "}.lst-kix_sryvi1qtsqre-8>li:before{content:"\0025a0  "}.lst-kix_6z2a8aoqt4nu-5>li:before{content:"\0025a0  "}.lst-kix_6z2a8aoqt4nu-7>li:before{content:"\0025cb  "}.lst-kix_sryvi1qtsqre-7>li:before{content:"\0025cb  "}.lst-kix_6z2a8aoqt4nu-2>li:before{content:"\0025a0  "}.lst-kix_6z2a8aoqt4nu-6>li:before{content:"\0025cf  "}.lst-kix_sryvi1qtsqre-6>li:before{content:"\0025cf  "}.lst-kix_n3kvfh5c5sox-0>li:before{content:"\0025cf  "}.lst-kix_6z2a8aoqt4nu-3>li:before{content:"\0025cf  "}.lst-kix_sryvi1qtsqre-3>li:before{content:"\0025cf  "}.lst-kix_sryvi1qtsqre-5>li:before{content:"\0025a0  "}.lst-kix_6z2a8aoqt4nu-4>li:before{content:"\0025cb  "}.lst-kix_sryvi1qtsqre-4>li:before{content:"\0025cb  "}ul.lst-kix_lqri8elulwgp-0{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-5.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-5 0}ul.lst-kix_lqri8elulwgp-2{list-style-type:none}ul.lst-kix_lqri8elulwgp-1{list-style-type:none}ul.lst-kix_lqri8elulwgp-4{list-style-type:none}ul.lst-kix_lqri8elulwgp-3{list-style-type:none}ul.lst-kix_lqri8elulwgp-6{list-style-type:none}ul.lst-kix_lqri8elulwgp-5{list-style-type:none}.lst-kix_6z2a8aoqt4nu-1>li:before{content:"\0025cb  "}ul.lst-kix_lqri8elulwgp-8{list-style-type:none}ul.lst-kix_lqri8elulwgp-7{list-style-type:none}.lst-kix_6z2a8aoqt4nu-0>li:before{content:"\0025cf  "}ul.lst-kix_6z2a8aoqt4nu-4{list-style-type:none}ul.lst-kix_6z2a8aoqt4nu-5{list-style-type:none}ul.lst-kix_6z2a8aoqt4nu-6{list-style-type:none}ul.lst-kix_6z2a8aoqt4nu-7{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-8.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-8 0}ul.lst-kix_3yb8nsh8libq-2{list-style-type:none}ul.lst-kix_6z2a8aoqt4nu-8{list-style-type:none}ul.lst-kix_3yb8nsh8libq-3{list-style-type:none}ul.lst-kix_3yb8nsh8libq-0{list-style-type:none}ul.lst-kix_3yb8nsh8libq-1{list-style-type:none}ul.lst-kix_6z2a8aoqt4nu-0{list-style-type:none}.lst-kix_wi57dyc2k2gr-7>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-7}ul.lst-kix_6z2a8aoqt4nu-1{list-style-type:none}ul.lst-kix_6z2a8aoqt4nu-2{list-style-type:none}ul.lst-kix_6z2a8aoqt4nu-3{list-style-type:none}ul.lst-kix_sryvi1qtsqre-0{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-6.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-6 0}.lst-kix_wi57dyc2k2gr-0>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-0,decimal) ". "}ul.lst-kix_3yb8nsh8libq-6{list-style-type:none}ul.lst-kix_sryvi1qtsqre-8{list-style-type:none}ul.lst-kix_3yb8nsh8libq-7{list-style-type:none}ul.lst-kix_sryvi1qtsqre-7{list-style-type:none}ul.lst-kix_3yb8nsh8libq-4{list-style-type:none}ul.lst-kix_sryvi1qtsqre-6{list-style-type:none}ul.lst-kix_3yb8nsh8libq-5{list-style-type:none}ul.lst-kix_sryvi1qtsqre-5{list-style-type:none}ul.lst-kix_sryvi1qtsqre-4{list-style-type:none}.lst-kix_wi57dyc2k2gr-0>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-0}ul.lst-kix_sryvi1qtsqre-3{list-style-type:none}ul.lst-kix_3yb8nsh8libq-8{list-style-type:none}ul.lst-kix_sryvi1qtsqre-2{list-style-type:none}ul.lst-kix_sryvi1qtsqre-1{list-style-type:none}.lst-kix_3yb8nsh8libq-8>li:before{content:"\0025a0  "}.lst-kix_wi57dyc2k2gr-6>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-6}ul.lst-kix_6q6a3mguvqiu-7{list-style-type:none}ul.lst-kix_6q6a3mguvqiu-6{list-style-type:none}ul.lst-kix_6q6a3mguvqiu-5{list-style-type:none}ul.lst-kix_6q6a3mguvqiu-4{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-0{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-1{list-style-type:none}ul.lst-kix_6q6a3mguvqiu-8{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-4{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-5{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-2{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-3{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-8{list-style-type:none}ul.lst-kix_6q6a3mguvqiu-3{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-0.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-0 0}ul.lst-kix_6q6a3mguvqiu-2{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-6{list-style-type:none}ul.lst-kix_6q6a3mguvqiu-1{list-style-type:none}ul.lst-kix_n3kvfh5c5sox-7{list-style-type:none}ul.lst-kix_6q6a3mguvqiu-0{list-style-type:none}.lst-kix_n3kvfh5c5sox-8>li:before{content:"\0025a0  "}.lst-kix_n3kvfh5c5sox-7>li:before{content:"\0025cb  "}.lst-kix_n3kvfh5c5sox-6>li:before{content:"\0025cf  "}ol.lst-kix_wi57dyc2k2gr-4.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-4 0}.lst-kix_wi57dyc2k2gr-3>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-3}ol.lst-kix_wi57dyc2k2gr-7{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-8{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-5{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-6{list-style-type:none}.lst-kix_6q6a3mguvqiu-1>li:before{content:"\0025cb  "}ol.lst-kix_wi57dyc2k2gr-0{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-7.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-7 0}ol.lst-kix_wi57dyc2k2gr-3{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-4{list-style-type:none}ol.lst-kix_wi57dyc2k2gr-1{list-style-type:none}.lst-kix_6q6a3mguvqiu-0>li:before{content:"\0025cf  "}ol.lst-kix_wi57dyc2k2gr-2{list-style-type:none}.lst-kix_3yb8nsh8libq-2>li:before{content:"\0025a0  "}.lst-kix_6q6a3mguvqiu-5>li:before{content:"\0025a0  "}.lst-kix_lqri8elulwgp-0>li:before{content:"\0025cf  "}.lst-kix_3yb8nsh8libq-1>li:before{content:"\0025cb  "}.lst-kix_3yb8nsh8libq-3>li:before{content:"\0025cf  "}.lst-kix_3yb8nsh8libq-4>li:before{content:"\0025cb  "}.lst-kix_3yb8nsh8libq-0>li:before{content:"\0025cf  "}.lst-kix_lqri8elulwgp-2>li:before{content:"\0025a0  "}.lst-kix_6q6a3mguvqiu-2>li:before{content:"\0025a0  "}.lst-kix_6q6a3mguvqiu-6>li:before{content:"\0025cf  "}.lst-kix_3yb8nsh8libq-6>li:before{content:"\0025cf  "}.lst-kix_3yb8nsh8libq-5>li:before{content:"\0025a0  "}.lst-kix_3yb8nsh8libq-7>li:before{content:"\0025cb  "}.lst-kix_6q6a3mguvqiu-3>li:before{content:"\0025cf  "}.lst-kix_lqri8elulwgp-1>li:before{content:"\0025cb  "}.lst-kix_6q6a3mguvqiu-4>li:before{content:"\0025cb  "}.lst-kix_wi57dyc2k2gr-5>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-5,lower-roman) ". "}.lst-kix_wi57dyc2k2gr-3>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-3,decimal) ". "}.lst-kix_wi57dyc2k2gr-4>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-4,lower-latin) ". "}ol.lst-kix_wi57dyc2k2gr-1.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-1 0}.lst-kix_wi57dyc2k2gr-1>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-1,lower-latin) ". "}.lst-kix_wi57dyc2k2gr-1>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-1}.lst-kix_wi57dyc2k2gr-2>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-2,lower-roman) ". "}.lst-kix_6q6a3mguvqiu-7>li:before{content:"\0025cb  "}.lst-kix_wi57dyc2k2gr-4>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-4}.lst-kix_6q6a3mguvqiu-8>li:before{content:"\0025a0  "}.lst-kix_lqri8elulwgp-7>li:before{content:"\0025cb  "}.lst-kix_lqri8elulwgp-8>li:before{content:"\0025a0  "}.lst-kix_wi57dyc2k2gr-6>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-6,decimal) ". "}.lst-kix_lqri8elulwgp-6>li:before{content:"\0025cf  "}.lst-kix_wi57dyc2k2gr-7>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-7,lower-latin) ". "}.lst-kix_wi57dyc2k2gr-8>li:before{content:"" counter(lst-ctn-kix_wi57dyc2k2gr-8,lower-roman) ". "}.lst-kix_lqri8elulwgp-3>li:before{content:"\0025cf  "}.lst-kix_lqri8elulwgp-4>li:before{content:"\0025cb  "}.lst-kix_lqri8elulwgp-5>li:before{content:"\0025a0  "}ol.lst-kix_wi57dyc2k2gr-2.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-2 0}.lst-kix_wi57dyc2k2gr-5>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-5}.lst-kix_wi57dyc2k2gr-2>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-2}.lst-kix_wi57dyc2k2gr-8>li{counter-increment:lst-ctn-kix_wi57dyc2k2gr-8}ol.lst-kix_wi57dyc2k2gr-3.start{counter-reset:lst-ctn-kix_wi57dyc2k2gr-3 0}ol{margin:0;padding:0}table td,table th{padding:0}.c5{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:middle;border-right-color:#b7b7b7;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:72pt;border-top-color:#666666;border-bottom-style:solid}.c40{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:0pt;border-right-width:1.5pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:1.5pt;border-top-style:solid;background-color:#efefef;border-left-style:solid;border-bottom-width:0pt;width:69.8pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c22{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:0pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:71.2pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c16{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:0pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:69.8pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c3{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#efefef;border-left-style:solid;border-bottom-width:1pt;width:513pt;border-top-color:#000000;border-bottom-style:solid}.c23{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:0pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#b7b7b7;border-left-width:1.5pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:72pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c89{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:0pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:73.5pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c76{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:0pt;border-right-width:1.5pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:1.5pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:69.8pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c86{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:74.2pt;border-top-color:#666666;border-bottom-style:solid}.c63{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:0pt;border-right-width:1.5pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:1.5pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:74.2pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c54{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:69.8pt;border-top-color:#666666;border-bottom-style:solid}.c93{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:71.2pt;border-top-color:#666666;border-bottom-style:solid}.c73{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:0pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:74.2pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c90{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:0pt;border-right-width:1.5pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:1.5pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:73.5pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c83{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:0pt;border-right-width:0pt;border-left-color:#b7b7b7;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:71.2pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c88{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:middle;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:74.2pt;border-top-color:#666666;border-bottom-style:solid}.c58{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#b7b7b7;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:72pt;border-top-color:#666666;border-bottom-style:solid}.c36{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:73.5pt;border-top-color:#666666;border-bottom-style:solid}.c81{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:middle;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:69.8pt;border-top-color:#666666;border-bottom-style:solid}.c80{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:middle;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:71.2pt;border-top-color:#666666;border-bottom-style:solid}.c66{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:0pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#b7b7b7;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:72pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c94{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:1pt;border-right-width:0pt;border-left-color:#b7b7b7;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:71.2pt;border-top-color:#666666;border-bottom-style:solid}.c92{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#666666;border-top-width:1pt;border-right-width:0pt;border-left-color:#ffffff;vertical-align:middle;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:73.5pt;border-top-color:#666666;border-bottom-style:solid}.c62{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:0pt;border-right-width:1.5pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:1.5pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:71.2pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c77{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#b7b7b7;border-top-width:0pt;border-right-width:1.5pt;border-left-color:#b7b7b7;vertical-align:top;border-right-color:#ffffff;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:71.2pt;border-top-color:#b7b7b7;border-bottom-style:solid}.c84{margin-left:-27pt;padding-top:0pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left;margin-right:-27pt}.c31{padding-top:10pt;padding-bottom:10pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left;height:18pt}.c46{padding-top:10pt;padding-bottom:0pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left;height:18pt}.c38{margin-left:36pt;padding-top:3pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c20{margin-left:36pt;padding-top:3pt;padding-bottom:4pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c26{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:13pt;font-family:"Overpass";font-style:normal}.c14{color:#383838;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Overpass";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Overpass";font-style:normal}.c15{padding-top:5pt;padding-bottom:10pt;line-height:1.14;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c33{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c64{padding-top:10pt;padding-bottom:10pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c9{color:#ff0000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Red Hat Text";font-style:normal}.c97{margin-left:72pt;padding-top:3pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c49{padding-top:10pt;padding-bottom:0pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c18{padding-top:0pt;padding-bottom:10pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c52{margin-left:18pt;padding-top:3pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c7{color:#383838;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Overpass";font-style:normal}.c27{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c85{padding-top:10pt;padding-bottom:0pt;line-height:1.1500000000000001;orphans:2;widows:2;text-align:left}.c0{padding-top:12pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c55{color:#434343;font-weight:700;text-decoration:none;vertical-align:baseline;font-family:"Red Hat Text";font-style:normal}.c82{padding-top:0pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c78{padding-top:4pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c95{padding-top:10pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c21{padding-top:0pt;padding-bottom:10pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c25{padding-top:10pt;padding-bottom:2pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c35{padding-top:5pt;padding-bottom:10pt;line-height:1.14;orphans:2;widows:2;text-align:left}.c6{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c72{padding-top:5pt;padding-bottom:0pt;line-height:1.14;orphans:2;widows:2;text-align:left}.c47{padding-top:12pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c12{padding-top:14pt;padding-bottom:4pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c79{padding-top:0pt;padding-bottom:10pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c10{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c17{color:#000000;text-decoration:none;vertical-align:baseline;font-size:12pt;font-style:normal}.c11{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center;height:11pt}.c43{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c48{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c30{color:#ff0000;text-decoration:none;vertical-align:baseline;font-style:normal}.c53{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c91{padding-top:0pt;padding-bottom:10pt;line-height:1.15;text-align:left}.c50{margin-left:auto;border-spacing:0;border-collapse:collapse;margin-right:auto}.c74{color:#434343;text-decoration:none;vertical-align:baseline;font-style:normal}.c42{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c24{border-spacing:0;border-collapse:collapse;margin-right:auto}.c34{color:#ee0000;text-decoration:none;vertical-align:baseline;font-style:normal}.c37{background-color:#ffffff;max-width:468pt;padding:90pt 72pt 72pt 72pt}.c60{background-color:#ffff00;font-weight:500;font-family:"Red Hat Text"}.c44{font-size:9pt;font-family:"Red Hat Text";font-weight:500}.c41{font-weight:700;font-family:"Overpass"}.c8{font-weight:400;font-family:"Overpass"}.c1{color:inherit;text-decoration:inherit}.c56{margin-left:36pt;padding-left:0pt}.c71{padding:0;margin:0}.c29{font-weight:400;font-family:"Red Hat Text"}.c68{font-weight:700;font-family:"Red Hat Text"}.c70{color:#ff0000}.c61{font-size:9pt}.c13{font-size:10pt}.c87{font-size:26pt}.c75{text-indent:36pt}.c4{height:0pt}.c32{font-size:14pt}.c19{height:11pt}.c59{font-size:30pt}.c39{font-style:italic}.c96{font-size:36pt}.c51{background-color:#ffffff}.c57{background-color:#efefef}.c69{font-weight:700}.c45{font-size:18pt}.c28{background-color:#f8f8f8}.c65{font-size:8.5pt}.c67{page-break-after:avoid}.title{padding-top:10pt;color:#ee0000;font-size:48pt;padding-bottom:10pt;font-family:"Red Hat Display";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#ee0000;font-weight:500;font-size:18pt;padding-bottom:10pt;font-family:"Red Hat Display";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Red Hat Text"}p{margin:0;color:#000000;font-size:11pt;font-family:"Red Hat Text"}h1{padding-top:0pt;color:#ee0000;font-size:26pt;padding-bottom:3pt;font-family:"Red Hat Display";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:10pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:10pt;font-family:"Red Hat Text";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:0pt;color:#434343;font-size:14pt;padding-bottom:10pt;font-family:"Red Hat Text";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:0pt;color:#ee0000;font-weight:700;font-size:12pt;padding-bottom:10pt;font-family:"Red Hat Text";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:0pt;font-family:"Red Hat Text";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Red Hat Text";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c37"><div><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 158.11px; height: 37.50px;"><img alt="" src="images/image2.jpg" style="width: 158.11px; height: 37.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></div><p class="c67 c95 title" id="h.66y4kqbj468a"><span class="c34 c8 c96">Exercise 3</span></p><p class="c21 c67 subtitle" id="h.5u5ugok56gd6"><span class="c8">Ansible K8S module</span></p><p class="c18"><span class="c17 c8"></span></p><p class="c21"><span class="c8 c32 c43">Date : 19/04/2020</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 531.00px; height: 583.00px;"><img alt="" src="images/image1.png" style="width: 720.00px; height: 932.80px; margin-left: -189.00px; margin-top: -295.54px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c19 c79"><span class="c43 c8 c32"></span></p><hr style="page-break-before:always;display:none;"><p class="c64 c19 title" id="h.n4cjyi9gv2e"><span class="c34 c8 c59"></span></p><p class="c64 title" id="h.9iysovqalrju"><span class="c34 c8 c59">Contents</span></p><p class="c78"><span class="c14"><a class="c1" href="#h.n4zfkq3fn1ym">Ansible Container</a></span><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c14"><a class="c1" href="#h.n4zfkq3fn1ym">2</a></span></p><p class="c52"><span class="c7"><a class="c1" href="#h.dwpc7cpnucwg">Download</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.dwpc7cpnucwg">2</a></span></p><p class="c52"><span class="c7"><a class="c1" href="#h.szaqif4kbza8">Image Testing</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.szaqif4kbza8">2</a></span></p><p class="c38"><span class="c7"><a class="c1" href="#h.4c3x208w2bqt">Hello, Ansible!</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.4c3x208w2bqt">2</a></span></p><p class="c52"><span class="c7"><a class="c1" href="#h.bj3a53lmx9ut">Running the Container</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.bj3a53lmx9ut">4</a></span></p><p class="c52"><span class="c7"><a class="c1" href="#h.ueshqwghcbb2">Kubernetes Module</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.ueshqwghcbb2">5</a></span></p><p class="c97"><span class="c7"><a class="c1" href="#h.adltkomz0y9u">Please select a number for each task</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.adltkomz0y9u">8</a></span></p><p class="c38"><span class="c7"><a class="c1" href="#h.9nd568a8bgq8">To create the ose-kuberentes container :</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.9nd568a8bgq8">9</a></span></p><p class="c52"><span class="c7"><a class="c1" href="#h.fb13u6mgdmzx">Generate kubeconfig</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.fb13u6mgdmzx">9</a></span></p><p class="c38"><span class="c7"><a class="c1" href="#h.ixxishkcbpjd">Author a service account spec</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.ixxishkcbpjd">9</a></span></p><p class="c38"><span class="c7"><a class="c1" href="#h.j02curvoxenz">Create the service account</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.j02curvoxenz">10</a></span></p><p class="c38"><span class="c7"><a class="c1" href="#h.9g0jsho5jck7">Fetch the name of the secrets used by the service account</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.9g0jsho5jck7">10</a></span></p><p class="c38"><span class="c7"><a class="c1" href="#h.dpr10tu5yyhi">Fetch the token from the secret</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.dpr10tu5yyhi">10</a></span></p><p class="c38"><span class="c7"><a class="c1" href="#h.rvadtrylafs5">Get the certificate info for the cluster</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.rvadtrylafs5">11</a></span></p><p class="c20"><span class="c7"><a class="c1" href="#h.y3dfpckaglqw">Create a kubeconfig file</a></span><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c7"><a class="c1" href="#h.y3dfpckaglqw">12</a></span></p><hr style="page-break-before:always;display:none;"><p class="c19 c91"><span class="c17 c8"></span></p><h1 class="c33" id="h.n4zfkq3fn1ym"><span class="c8">Ansible Container</span></h1><h2 class="c31" id="h.f23a84m8jctr"><span class="c43 c41 c45"></span></h2><p class="c21"><span class="c10 c8">In today&rsquo;s world it is much easier to just run a container then to install an application on our Laptops , for that reason Red Hat has developed 2 containers for running ansible with the Kubernetes module.</span></p><h2 class="c64" id="h.dwpc7cpnucwg"><span class="c43 c41 c45">Download</span></h2><p class="c21"><span class="c8">To obtain the package run the following command &nbsp;:</span></p><a id="t.d47bc376363745a57305fd6923f397a4a1a5a077"></a><a id="t.0"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c8 c13"># podman pull registry.infra.local:5000/openshift3/ose-ansible</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8 c57"></span></p><h2 class="c64" id="h.szaqif4kbza8"><span class="c43 c41 c45">Image Testing</span></h2><p class="c21"><span class="c10 c8">&nbsp;Now that we obtain the Image we need , lets run it with a small test run to make sure everything is working properly:</span></p><h3 class="c21 c67" id="h.4c3x208w2bqt"><span class="c29 c32 c74">Hello, Ansible!</span></h3><p class="c21"><span class="c10 c8">At its most basic, Ansible can be used to run tasks on the same machine running the Ansible playbook, by running against localhost , and telling Ansible this is a &ldquo;local&rdquo; connection (Ansible defaults to trying to connect to any host&mdash;even localhost &mdash;via</span></p><p class="c21"><span class="c10 c8">SSH).</span></p><p class="c21"><span class="c8">Let&rsquo;s start off writing a basic playbook, which will run the date command, store its result in a variable, and then print the result in a debug message.<br>Before writing the playbook, create a file named inventory to tell Ansible how to connect to localhost :</span></p><a id="t.678eedb1f4aea0f9fd9671097e67eb7fda054ec7"></a><a id="t.1"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># mkdir ose-ansible &amp;&amp; cd ose-ansible</span></p><p class="c6"><span class="c2"># cat &gt;&gt; inventory &lt;&lt; EOF</span></p><p class="c6"><span class="c2">[localhost]</span></p><p class="c6"><span class="c2">127.0.0.1 ansible_connection=local</span></p><p class="c6"><span class="c2">EOF</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c8">Every playbook starts with a play, which is a root level list item, with at least one key, hosts . To run a playbook against the local machine, you can set the following line at the beginning of the playbook, in a new file named main.yaml :</span></p><a id="t.29bbbf5f80b7c62b37b14a3a5fec8bda516a4022"></a><a id="t.2"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2">---</span></p><p class="c6"><span class="c2">- hosts: localhost</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c10 c8">When connecting to localhost and running simple automation tasks, you should usually disable Ansible&rsquo;s fact-gathering functionality. Often this is not needed and can save time in your playbook runs. When it is enabled, Ansible digs through the system and stores tons of environment information in variables before it begins running tasks.</span></p><p class="c6"><span class="c10 c8">So, to do this, the next line should be: &ldquo;gather_facts: false&rdquo;</span></p><p class="c6"><span class="c10 c8">Next up, we&rsquo;re going to write our first-ever Ansible task, to run the date command and capture its output:</span></p><p class="c18"><span class="c17 c8"></span></p><a id="t.aea92549f08d511532b0108b10aea677ce2c10bd"></a><a id="t.3"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2">tasks:</span></p><p class="c6"><span class="c2">&nbsp; - name: Get the current date.</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; command: date</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; register: current_date</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; changed_when: false</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c10 c8">The tasks keyword should be on the same level as hosts , etc., and then all the tasks should be in a YAML list under tasks .</span></p><p class="c6"><span class="c10 c8">It&rsquo;s best practice to name every task you write in Ansible. This serves two purposes:</span></p><p class="c6 c75"><span class="c10 c8">1. The name serves as an inline comment describing the task in YAML.</span></p><p class="c6 c75"><span class="c10 c8">2. The value of the name will be printed in Ansible&rsquo;s output as the name of the task when it runs.</span></p><p class="c6"><span class="c10 c8">A name is not strictly required, but it&rsquo;s a lot easier to debug your playbooks if you name things after what they are doing!</span></p><p class="c6"><span class="c10 c8">This first task uses Ansible&rsquo;s command module, which takes the value of the command and runs it. So this would be the equivalent of running the date command on the command line.</span></p><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c8 c10">The task also registers the returned value (and some other metadata) into a new variable current_date , and because we know running date will never change the state of the host it&rsquo;s run on, we also add changed_when: false . This helps Ansible keep track of state&mdash;later we will use this to our advantage!</span></p><p class="c6"><span class="c10 c8">Let&rsquo;s add just one more task that will print the date we saved. </span></p><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c8">So far, your entire playbook should look like this:</span></p><a id="t.d5255b3cbd368302e45d91cba070c3a66b854ae7"></a><a id="t.4"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2">---</span></p><p class="c6"><span class="c2">- hosts: localhost</span></p><p class="c6"><span class="c2">&nbsp; gather_facts: false</span></p><p class="c6 c19"><span class="c2"></span></p><p class="c6"><span class="c2">&nbsp; tasks:</span></p><p class="c6"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: Get the current date.</span></p><p class="c6"><span class="c2">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command: date</span></p><p class="c6"><span class="c2">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register: current_date</span></p><p class="c6"><span class="c2">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changed_when: false</span></p><p class="c6 c19"><span class="c2"></span></p><p class="c6"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: Print the Current date.</span></p><p class="c6"><span class="c2">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg: &quot;{{ current_date.stdout }}&quot;</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c10 c8">It may not look like this now but if you Copy/Paste the playbook to your terminal , you will see that the indentations are correct.</span></p><p class="c6 c19"><span class="c10 c8"></span></p><h2 class="c49" id="h.bj3a53lmx9ut"><span class="c43 c45 c68">Running the Container </span></h2><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c8">Now that we have our files in place lets make sure the ansible container can run with our newly created files:</span></p><a id="t.80b00425b327d97e68b5fdc610f05c847bfd478a"></a><a id="t.5"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># podman run --rm --name ose-ansible -tu `id -u` \</span></p><p class="c6"><span class="c2">-v $HOME/.ssh/id_rsa:/opt/app-root/src/.ssh/id_rsa:Z,ro \</span></p><p class="c6"><span class="c2">-v $HOME/ose-ansible/inventory:/tmp/inventory:Z,ro &nbsp;\</span></p><p class="c6"><span class="c2">-e INVENTORY_FILE=/tmp/inventory -e OPTS=&quot;-v&quot; &nbsp;\</span></p><p class="c6"><span class="c2">-v $HOME/ose-ansible/:/opt/app-root/ose-ansible/:Z,ro \</span></p><p class="c6"><span class="c2">-e PLAYBOOK_FILE=/opt/app-root/ose-ansible/main.yaml \</span></p><p class="c6"><span class="c2">registry.infra.local:5000/openshift3/ose-ansible</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6 c19"><span class="c10 c8"></span></p><hr style="page-break-before:always;display:none;"><h2 class="c46" id="h.u6v0outu1cdl"><span class="c43 c68 c45"></span></h2><h2 class="c49" id="h.ueshqwghcbb2"><span class="c43 c68 c45">Kubernetes Module</span></h2><p class="c21"><span class="c10 c29">Now that we are able to run ansible from our container let&rsquo;s switch our focus to the kubernetes module.</span></p><p class="c6"><span class="c10 c29">Now that we created the Namespace we can continue.</span></p><p class="c82"><span>Next, we&#39;ll use the Ansible k8s module to leverage existing Kubernetes and OpenShift Resource files. Let&#39;s take the</span><span><a class="c1" href="https://www.google.com/url?q=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/%23creating-a-deployment&amp;sa=D&amp;ust=1587641988837000">&nbsp;</a></span><span class="c48 c69"><a class="c1" href="https://www.google.com/url?q=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/%23creating-a-deployment&amp;sa=D&amp;ust=1587641988838000">nginx deployment example</a></span><span class="c10 c29">&nbsp;from the Kubernetes docs.</span></p><p class="c0"><span class="c69">Note</span><span>: </span><span class="c39">We&#39;ve modified the resource file slightly as we will be deploying on OpenShift.</span></p><a id="t.c2b369e56b410a4e5c68d605abbd832aaac44cc7"></a><a id="t.6"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2 c28"># cat &gt; nginx-deployment.yml &lt;&lt; EOF</span></p><p class="c6"><span class="c2 c28">kind: DeploymentConfig</span></p><p class="c6"><span class="c2 c28">apiVersion: v1</span></p><p class="c6"><span class="c2 c28">metadata:</span></p><p class="c6"><span class="c2 c28">&nbsp; name: nginx-deployment</span></p><p class="c6"><span class="c2 c28">spec:</span></p><p class="c6"><span class="c2 c28">&nbsp; template:</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; metadata:</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; &nbsp; labels:</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; &nbsp; &nbsp; name: nginx</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; spec:</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; &nbsp; Containers:</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; &nbsp; &nbsp; - name: nginx</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image: nginx:1.15.4</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ports:</span></p><p class="c6"><span class="c2 c28">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - containerPort: 80</span></p><p class="c6"><span class="c2 c28">&nbsp; replicas: 3</span></p><p class="c6"><span class="c2 c28">&nbsp; selector:</span></p><p class="c6"><span class="c8 c13 c28">&nbsp; &nbsp; name: nginx</span></p><p class="c6"><span class="c8 c13 c28">EOF</span></p></td></tr></tbody></table><p class="c25"><span>Copy the nginx deployment definition nginx-deployment.yml into example-role/templates, adding a .j2 extension</span></p><a id="t.556efab89ffb3deae4a9af25422def3802c5b37c"></a><a id="t.7"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c27"><span class="c10 c29"># cp nginx-deployment.yml roles/Example-role/templates/nginx-deployment.yml.j2</span></p></td></tr></tbody></table><p class="c25"><span>Update tasks file Example-role/tasks/main.yml to create the nginx deployment using the k8s module</span></p><a id="t.71316e794f70594a8aa25563ce8d6055a976baa9"></a><a id="t.8"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c27"><span class="c10 c29">---</span></p><p class="c27"><span class="c10 c29">- name: set test namespace to {{ state }}</span></p><p class="c27"><span class="c10 c29">&nbsp; k8s:</span></p><p class="c27"><span class="c10 c29">&nbsp; &nbsp;api_version: v1</span></p><p class="c27"><span class="c10 c29">&nbsp; &nbsp;kind: Namespace</span></p><p class="c27"><span>&nbsp; &nbsp;name: </span><span class="c8 c13">project-${USER}</span></p><p class="c27"><span class="c10 c29">&nbsp; &nbsp;state: &quot;{{ state }}&quot;</span></p><p class="c27 c19"><span class="c10 c29"></span></p><p class="c27"><span class="c10 c29">- name: set nginx deployment to {{ state }}</span></p><p class="c27"><span class="c10 c29">&nbsp; k8s:</span></p><p class="c27"><span class="c10 c29">&nbsp; &nbsp;state: &quot;{{ state }}&quot;</span></p><p class="c27"><span class="c10 c29">&nbsp; &nbsp;definition: &quot;{{ lookup(&#39;template&#39;, &#39;nginx-deployment.yml.j2&#39;) }}&quot;</span></p><p class="c27"><span>&nbsp; &nbsp;namespace: project-</span><span class="c8 c13">${USER}</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c29"></span></p><p class="c25"><span class="c10 c29">Run the Playbook to deploy nginx on to OpenShift</span></p><p class="c6"><span>Running the Playbook with the command below will read the state variable defined in example-role/defaults/main.yml</span></p><a id="t.0e57ca7c21fff3a032421dd7d7dd53b91911cd3d"></a><a id="t.9"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># podman run ...</span></p></td></tr></tbody></table><p class="c25"><span>And remove leftovers :</span></p><a id="t.6cbb7af6c4db6c859536d05bcb2e0b7f358d4f0b"></a><a id="t.10"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># podman rm ose-kubernetes</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c29"></span></p><p class="c6"><span>You can see the test namespace created and the nginx deployment created in the new namespace.</span></p><a id="t.c7f59433d53fe69094dbbcb11a92b9d1fbbd344f"></a><a id="t.11"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># oc get all -n test</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c29"></span></p><p class="c6"><span>Next, let&#39;s make it possible to customize the replica count for our</span><span><a class="c1" href="https://www.google.com/url?q=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/%23creating-a-deployment&amp;sa=D&amp;ust=1587641988846000">&nbsp;</a></span><span class="c48"><a class="c1" href="https://www.google.com/url?q=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/%23creating-a-deployment&amp;sa=D&amp;ust=1587641988846000">nginx deployment</a></span><span class="c10 c29">** by adding an nginx_replicas variable to the DeploymentConfig template and filling the variable value dynamically with Ansible.</span></p><p class="c25"><span>Modify vars file example-role/defaults/main.yml, setting nginx_replicas: 2</span></p><a id="t.8f354a8f8154ee06864b064517552165a13962d8"></a><a id="t.12"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2">---</span></p><p class="c6"><span class="c2">state: present</span></p><p class="c6"><span class="c2">nginx_replicas: 2</span></p></td></tr></tbody></table><p class="c25"><span>Modify nginx deployment definition nginx-deployment.yml.j2 to read replicas from the nginx_replicas variable</span></p><a id="t.b775df2775ed1195b3d4f302af69f0d58fd4888f"></a><a id="t.13"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2">kind: DeploymentConfig</span></p><p class="c6"><span class="c2">apiVersion: v1</span></p><p class="c6"><span class="c2">metadata:</span></p><p class="c6"><span class="c2">&nbsp; name: nginx-deployment</span></p><p class="c6"><span class="c2">spec:</span></p><p class="c6"><span class="c2">&nbsp; template:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; metadata:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; labels:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; name: nginx</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; spec:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; containers:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; - name: nginx</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image: nginx:1.15.4</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ports:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - containerPort: 80</span></p><p class="c6"><span class="c2">&nbsp; replicas: &quot;{{ nginx_replicas }}&quot;</span></p><p class="c6"><span class="c2">&nbsp; selector:</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; name: nginx</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c29"></span></p><p class="c6"><span>Running the Playbook again will read the variable nginx_replicas and use the provided value to customize the nginx DeploymentConfig.</span></p><a id="t.ef583ed1a4fdc2ad4328f9c49c999268b79730aa"></a><a id="t.14"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># podman run -...</span></p></td></tr></tbody></table><p class="c25"><span class="c10 c8">Clean it up.</span></p><a id="t.6cbb7af6c4db6c859536d05bcb2e0b7f358d4f0b"></a><a id="t.15"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># podman rm ose-kubernetes</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c29"></span></p><p class="c25"><span>After running the Playbook, the cluster will scale down one of the nginx pods to meet the new requested replica count of 2. </span></p><a id="t.c7f59433d53fe69094dbbcb11a92b9d1fbbd344f"></a><a id="t.16"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># oc get all -n test</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c29"></span></p><p class="c25 c19"><span class="c17 c8"></span></p><p class="c18"><span class="c17 c8"></span></p><p class="c18"><span class="c9"></span></p><hr style="page-break-before:always;display:none;"><p class="c18"><span class="c30 c29 c32"></span></p><p class="c21"><span class="c30 c29 c32">Rate Yourself </span></p><h5 class="c67 c85" id="h.adltkomz0y9u"><span class="c8">Please select a number for each task</span></h5><p class="c72"><span class="c8 c13">In the next section please rate the difficulty of the task based on your skill :</span></p><p class="c72 c19"><span class="c43 c8 c65"></span></p><a id="t.16bb716aa486680efcc2f44ba3edc183b477d135"></a><a id="t.17"></a><table class="c50"><tbody><tr class="c4"><td class="c51 c80" colspan="1" rowspan="1"><p class="c53"><span class="c34 c8 c13">Task</span></p></td><td class="c80 c51" colspan="1" rowspan="1"><p class="c42"><span class="c8 c13 c34">5</span></p></td><td class="c51 c92" colspan="1" rowspan="1"><p class="c42"><span class="c34 c8 c13">4</span></p></td><td class="c51 c81" colspan="1" rowspan="1"><p class="c42"><span class="c34 c8 c13">3</span></p></td><td class="c51 c88" colspan="1" rowspan="1"><p class="c42"><span class="c34 c8 c13">2</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c42"><span class="c34 c8 c13">1</span></p></td></tr><tr class="c4"><td class="c94" colspan="1" rowspan="1"><p class="c53"><span class="c2">1</span></p></td><td class="c93" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c54" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c86" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c58" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td></tr><tr class="c4"><td class="c77 c57" colspan="1" rowspan="1"><p class="c53"><span class="c2">2</span></p></td><td class="c57 c62" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c90 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c63 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c23 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td></tr><tr class="c4"><td class="c77" colspan="1" rowspan="1"><p class="c53"><span class="c2">3</span></p></td><td class="c62" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c90" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c76" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c63" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td></tr><tr class="c4"><td class="c77 c57" colspan="1" rowspan="1"><p class="c53"><span class="c2">4</span></p></td><td class="c62 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c90 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c63 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c23 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td></tr><tr class="c4"><td class="c51 c77" colspan="1" rowspan="1"><p class="c53"><span class="c2">5</span></p></td><td class="c62 c51" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c90 c51" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c51 c76" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c63 c51" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c23 c51" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td></tr><tr class="c4"><td class="c77 c57" colspan="1" rowspan="1"><p class="c53"><span class="c2">6</span></p></td><td class="c62 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c57 c90" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c57 c63" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c23 c57" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td></tr><tr class="c4"><td class="c51 c83" colspan="1" rowspan="1"><p class="c53"><span class="c2">7</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c51 c89" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c51 c73" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td><td class="c51 c66" colspan="1" rowspan="1"><p class="c11"><span class="c2"></span></p></td></tr></tbody></table><p class="c35 c19"><span class="c10 c8"></span></p><p class="c35 c19"><span class="c10 c8"></span></p><hr style="page-break-before:always;display:none;"><p class="c19 c35"><span class="c10 c8"></span></p><h3 class="c15" id="h.9nd568a8bgq8"><span class="c32 c55">To create the ose-kuberentes container :</span></h3><p class="c19 c25"><span class="c17 c8"></span></p><a id="t.7054c62c9ebf5b2dbf7ee802e0febd2de1aaa2ee"></a><a id="t.18"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># sudo yum reinstall -y --downloadonly --downloaddir=./ python2-certifi python2-dictdiffer python2-google-auth python2-kubernetes python2-oauthlib python2-openshift python2-pyasn1-modules python2-requests-oauthlib python2-rsa python2-ruamel-ordereddict python2-ruamel-yaml python2-six python2-string_utils python2-typing python-cachetools python-jwcrypto python-websocket-client</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c8">Now use the following Dockerfile :</span></p><a id="t.db9d774f7dac8c13204fa9a3a6623e9d9014e020"></a><a id="t.19"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2">FROM registry.infra.local:5000/openshift3/ose-ansible</span></p><p class="c6"><span class="c2">MAINTAINER &nbsp;Meemail me@comefind.me # not a real email</span></p><p class="c6 c19"><span class="c2"></span></p><p class="c6"><span class="c2">USER root</span></p><p class="c6"><span class="c2">WORKDIR /opt/app-root/</span></p><p class="c6"><span class="c2">COPY python/python* .</span></p><p class="c6"><span class="c2">RUN yum install -y python*</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c8">Build the container :</span></p><a id="t.df8e329986d4f6207e6129283534179a162e33b0"></a><a id="t.20"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c8 c13"># buildah bud -f Dockerfile -t </span><span class="c8">ose-kubernetes .</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><h2 class="c12" id="h.fb13u6mgdmzx"><span class="c43 c68 c45">Generate kubeconfig</span></h2><h3 class="c12" id="h.ixxishkcbpjd"><span class="c26">Author a service account spec</span></h3><p class="c0"><span class="c8">To create a service account on Kubernetes, you can leverage kubectl and a service account spec. Create a YML file name </span><span class="c8 c39">sa.yml</span><span class="c10 c8">&nbsp;that looks like the one below:</span></p><p class="c0"><span class="c10 c41">sa.yml</span></p><p class="c6 c19"><span class="c17 c8"></span></p><a id="t.2ecd9a8b3beddca812fcc14e30322d70c33bb8bd"></a><a id="t.21"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># cat &gt; sa.yaml &lt;&lt; EOF</span></p><p class="c6"><span class="c8 c13">&nbsp;</span><span class="c10 c8">apiVersion: v1</span></p><p class="c6"><span class="c10 c8">kind: ServiceAccount</span></p><p class="c6"><span class="c10 c8">metadata:</span></p><p class="c6"><span class="c10 c8">&nbsp; Name: ${USER}</span></p><p class="c6"><span class="c10 c8">EOF</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6 c19"><span class="c10 c8"></span></p><h3 class="c12" id="h.j02curvoxenz"><span class="c26">Create the service account</span></h3><p class="c0"><span class="c8">You can create a service account by running the following command:</span></p><a id="t.62ca0b4e484e0a6208d2edd0fb1066dfd4920d79"></a><a id="t.22"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c8 c13"># </span><span class="c8">oc create -f sa.yaml</span></p></td></tr></tbody></table><p class="c0"><span class="c10 c8">This will use your personal account to create the service account. Make sure your personal account has permissions to do this.</span></p><h3 class="c12" id="h.9g0jsho5jck7"><span class="c26">Fetch the name of the secrets used by the service account</span></h3><p class="c0"><span class="c8">This can be found by running the following command:</span></p><a id="t.8ad046c653bfb495a65f461689c8772c635de379"></a><a id="t.23"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c8 c13"># </span><span class="c8">oc describe serviceAccounts ${USER}</span></p></td></tr></tbody></table><p class="c0"><span class="c41">Output :</span></p><a id="t.878a32a62026a400e9f4c6dbead82651298c4d1a"></a><a id="t.24"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2">Name: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user01</span></p><p class="c6"><span class="c2">Namespace: &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;project-user01</span></p><p class="c6"><span class="c2">Labels: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;none&gt;</span></p><p class="c6"><span class="c2">Annotations: &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;none&gt;</span></p><p class="c6"><span class="c2">Image pull secrets: &nbsp;user01-dockercfg-95wws</span></p><p class="c6"><span class="c2">Mountable secrets: &nbsp; user01-dockercfg-95wws</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user01-token-sk287</span></p><p class="c6"><span class="c8 c13">Tokens: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user01-token-sk287 &larr; </span><span class="c8 c13 c30">{{ this is what you need }}</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user01-token-t4nl6</span></p><p class="c6"><span class="c2">Events: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;none&gt;</span></p><p class="c6 c19"><span class="c2"></span></p></td></tr></tbody></table><p class="c0"><span class="c10 c8">Note down the Mountable secrets information which has the name of the secret that holds the token</span></p><h3 class="c12" id="h.dpr10tu5yyhi"><span class="c26">Fetch the token from the secret</span></h3><p class="c0"><span class="c8">Using the Mountable secrets value, you can get the token used by the service account. Run the following command to extract this information:</span></p><a id="t.89233c727ed9b533cfbc95aef295b3c5fa6e7767"></a><a id="t.25"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c2"># oc describe secrets user01-token-sk287</span></p><p class="c6"><span class="c2">Name: &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user01-token-sk287</span></p><p class="c6"><span class="c2">Namespace:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;project-user01</span></p><p class="c6"><span class="c2">Labels: &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;none&gt;</span></p><p class="c6"><span class="c2">Annotations: &nbsp;kubernetes.io/service-account.name: user01</span></p><p class="c6"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kubernetes.io/service-account.uid: 2b94cdc6-59dd-438c-8f65-443218471241</span></p><p class="c6 c19"><span class="c2"></span></p><p class="c6"><span class="c2">Type: &nbsp;kubernetes.io/service-account-token</span></p><p class="c6 c19"><span class="c2"></span></p><p class="c6"><span class="c2">Data</span></p><p class="c6"><span class="c2">====</span></p><p class="c6"><span class="c2">ca.crt: &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5932 bytes</span></p><p class="c6"><span class="c2">namespace: &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14 bytes</span></p><p class="c6"><span class="c2">service-ca.crt: &nbsp;7145 bytes</span></p><p class="c6"><span class="c8 c13">token: &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eyJhbGciOiJSUzI1NiIsImtpZCI6IlExOU41eGc0X2paTUx3Sk9GcXdDTV9zdjRKUEIzeHVBZnlWa1dPWW9SS28ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJwcm9qZWN0LXVzZXIwMSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJ1c2VyMDEtdG9rZW4tc2syODciLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoidXNlcjAxIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMmI5NGNkYzYtNTlkZC00MzhjLThmNjUtNDQzMjE4NDcxMjQxIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OnByb2plY3QtdXNlcjAxOnVzZXIwMSJ9.cDiDLhDxb3nC8Pyyc_ADLr--NhH4wAwboJoq_3KV0J8y_g9GR3sEmfx9gtxgBFbH2cqxEAIoUN40A38PHW-T72Y8z5DdDCGBFpQM8zFA7LuasxvbBCfmlcChZlR7-IRo3aPlOL2w2N_U37ipHnnTeHURiPawD5XQv7hf5nXRKYz5pe9rvoRXZs4a9n2LwJG509hEwUud6nO7eDu0nGRNU0prXx1mQYM92PXwDmGG7WVhQ5zzS6t77CBlah9aV4YF2kuTBTOvELvEGsJl8dAP2ghNUFvjPF-wtZjqqVDOx3qQCRNIAbJa-tl2qMsRWFvzNV0d_prIc0s6vvSvy0omRg &larr; </span><span class="c8 c70 c13">{{ this is what you need }}</span></p><p class="c6 c19"><span class="c2"></span></p><p class="c6 c19"><span class="c2"></span></p></td></tr></tbody></table><p class="c0"><span class="c10 c8">This will output the token information that looks something like above. Note down the token value</span></p><h3 class="c12" id="h.rvadtrylafs5"><span class="c26">Get the certificate info for the cluster</span></h3><p class="c0"><span class="c8">Every cluster has a certificate that clients can use to encryt traffic. Fetch the certificate and write to a file by running this command. In this case, we are using a file name cluster-cert.txt</span></p><a id="t.805ba502cf2d8fc68185ce02cdfa8eb4f3ccbb56"></a><a id="t.26"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c10 c8"># oc config view --flatten --minify &gt; cluster-cert.txt</span></p><p class="c6 c19"><span class="c2"></span></p><p class="c6"><span class="c2"># &nbsp;cat cluster-cert.txt</span></p><p class="c6"><span class="c2">apiVersion: v1</span></p><p class="c6"><span class="c2">clusters:</span></p><p class="c6"><span class="c2">- cluster:</span></p><p class="c6"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insecure-skip-tls-verify: true</span></p><p class="c6"><span class="c8 c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server: </span><span class="c48 c8 c13"><a class="c1" href="https://www.google.com/url?q=https://api.ocp4.infra.local:6443&amp;sa=D&amp;ust=1587641988876000">https://api.ocp4.infra.local:6443</a></span><span class="c8 c13">&nbsp;&larr; </span><span class="c8 c13 c70">{{ this is what you need }}</span></p><p class="c6"><span class="c2">&nbsp; name: api-ocp4-infra-local:6443</span></p><p class="c6"><span class="c2">contexts:</span></p><p class="c6"><span class="c2">- context:</span></p><p class="c6"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster: api-ocp4-infra-local:6443</span></p><p class="c6"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namespace: project-user01</span></p><p class="c6"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user: user01/api-ocp4-infra-local:6443</span></p><p class="c6"><span class="c2">&nbsp; name: project-user01/api-ocp4-infra-local:6443/user01</span></p><p class="c6"><span class="c2">current-context: project-user01/api-ocp4-infra-local:6443/user01</span></p><p class="c6"><span class="c2">kind: Config</span></p><p class="c6"><span class="c2">preferences: {}</span></p><p class="c6"><span class="c2">users:</span></p><p class="c6"><span class="c2">- name: user01/api-ocp4-infra-local:6443</span></p><p class="c6"><span class="c2">&nbsp; user:</span></p><p class="c6"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;token: EAkB_pyYCeSUw65NZMQeqvLzoE8Svdn_KRRfrZGgSMs</span></p></td></tr></tbody></table><p class="c0"><span class="c10 c8">Copy two pieces of information from here certificate-authority-data and server</span></p><h3 class="c12" id="h.y3dfpckaglqw"><span class="c26">Create a kubeconfig file</span></h3><p class="c47"><span class="c10 c8">From the steps above, you should have the following pieces of information</span></p><ul class="c71 lst-kix_3yb8nsh8libq-0 start"><li class="c47 c56"><span class="c10 c8">token</span></li><li class="c6 c56"><span class="c10 c8">Certificate-authority-data</span></li><li class="c6 c56"><span class="c10 c8">server</span></li></ul><p class="c47"><span class="c8">Create a file called auth/kubeconfig and paste this content on to it</span></p><a id="t.8fa2c3ae2f4af542bdd19c04b9fbd5a511025f11"></a><a id="t.27"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c10 c8">#cat &gt; auth/kubeconfig &lt;&lt; EOF</span></p><p class="c6"><span class="c10 c8">apiVersion: v1</span></p><p class="c6"><span class="c10 c8">kind: Config</span></p><p class="c6"><span class="c10 c8">users:</span></p><p class="c6"><span class="c10 c8">- name: ${USER}</span></p><p class="c6"><span class="c10 c8">&nbsp; user:</span></p><p class="c6"><span class="c10 c8">&nbsp; &nbsp; token: &lt;replace this with token info&gt;</span></p><p class="c6"><span class="c10 c8">clusters:</span></p><p class="c6"><span class="c10 c8">- cluster:</span></p><p class="c6"><span class="c10 c8">&nbsp; &nbsp; certificate-authority-data: &lt;replace this with certificate-authority-data info&gt;</span></p><p class="c6"><span class="c10 c8">&nbsp; &nbsp; server: &lt;replace this with server info&gt;</span></p><p class="c6"><span class="c10 c8">&nbsp; name: self-hosted-cluster</span></p><p class="c6"><span class="c10 c8">contexts:</span></p><p class="c6"><span class="c10 c8">- context:</span></p><p class="c6"><span class="c10 c8">&nbsp; &nbsp; cluster: self-hosted-cluster</span></p><p class="c6"><span class="c10 c8">&nbsp; &nbsp; user: ${USER}</span></p><p class="c6"><span class="c10 c8">&nbsp; name: ${USER}</span></p><p class="c6"><span class="c10 c8">current-context: svcs-acct-context</span></p><p class="c6"><span class="c10 c8">EOF</span></p></td></tr></tbody></table><p class="c0 c19"><span class="c10 c8"></span></p><p class="c0"><span class="c10 c8">Replace the placeholder above with the information gathered so far</span></p><ul class="c71 lst-kix_6q6a3mguvqiu-0 start"><li class="c0 c56"><span class="c10 c8">replace the token</span></li><li class="c0 c56"><span class="c10 c8">replace the certificate-authority-data</span></li><li class="c0 c56"><span class="c8">replace the server</span></li></ul><a id="t.9e694896e9bdddc3d56bc4c0275d984981c7200c"></a><a id="t.28"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c8 c13"># </span><span class="c8">oc adm policy add-role-to-user admin system:serviceaccount:project-user01:${USER}</span></p></td></tr></tbody></table><p class="c0 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c10 c8">Now run the new docker image :</span></p><p class="c6 c19"><span class="c10 c8"></span></p><a id="t.76456f01832bb99b945def3bb3da5534b702801c"></a><a id="t.29"></a><table class="c24"><tbody><tr class="c4"><td class="c3" colspan="1" rowspan="1"><p class="c6"><span class="c8 c13"># </span><span class="c8">podman run --rm --name ose-kubernetes -tu `id -u` -v $HOME/.ssh/id_rsa:/opt/app-root/src/.ssh/id_rsa:Z,ro -v $HOME/ose-kubernetes/inventory:/tmp/inventory:Z,ro &nbsp;-e INVENTORY_FILE=/tmp/inventory -v $HOME/auth/kubeconfig:/opt/app-root/src/kubeconfig:Z,ro -e K8S_AUTH_KUBECONFIG=/opt/app-root/src/kubeconfig -e OPTS=&quot;-v&quot; -v $HOME/ose-kubernetes/playbook.yaml:/opt/app-root/ose-ansible/playbook.yaml:Z,ro -v $HOME/ose-kubernetes/roles:/opt/app-root/ose-ansible/roles:Z,ro -e PLAYBOOK_FILE=/opt/app-root/ose-ansible/playbook.yaml registry.infra.local:5000/openshift3/ose-kubernetes</span></p></td></tr></tbody></table><p class="c6 c19"><span class="c10 c8"></span></p><p class="c6"><span class="c30 c29 c32">(What do you See wrong with this image ???)</span></p><p class="c6 c19"><span class="c10 c8"></span></p><div><p class="c84 c19"><span class="c43 c13 c60"></span></p><p class="c84"><span class="c60 c61">Footer Contents</span><span class="c44">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></div></body></html>